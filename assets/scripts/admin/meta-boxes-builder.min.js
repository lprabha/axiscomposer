function axisbuilder_log(a,b){if(void 0===typeof console)return!0;var c=void 0!==typeof b?b===!0?a:"[AB_"+b.charAt(0).toUpperCase()+b.slice(1).toLowerCase()+"] - "+a:"[AB_Logger] - "+a;console.log(b?c:a)}"yes"===axisbuilder_admin_meta_boxes_builder.debug_mode&&new axisbuilder_log("AxisBuilder Debug Mode is enabled","debug"),function(a){"use strict";a.AxisBuilder=function(){this.wpDefaultEditorWrap=a("#postdivrich"),this.wpDefaultEditorArea=a("#content.wp-editor-area"),this.axisBuilderDebug=axisbuilder_admin_meta_boxes_builder.debug_mode||{},this.axisBuilderButton=a("#axisbuilder-button"),this.axisBuilderHandle=a("#axisbuilder-handle").find(".control-bar"),this.axisBuilderCanvas=a("#axisbuilder-canvas").find(".canvas-area"),this.axisBuilderValues=a("#axisbuilder-canvas").find(".canvas-data"),this.axisBuilderParent=this.axisBuilderCanvas.parents(".postbox:eq(0)"),this.axisBuilderStatus=this.axisBuilderParent.find("input[name=axisbuilder_status]"),this.tinyMceDefined="undefined"!=typeof window.tinyMCE?!0:!1,this.tinyMceVersion=this.tinyMceDefined?window.tinyMCE.majorVersion:!1,this.tinyMceContent=this.tinyMceDefined?window.tinyMCE.get("content"):!1,this.shortcodes=a.AxisBuilderShortcodes||{},this.shortcodesWrap=a(".axisbuilder-shortcodes"),this.shortcodesData='textarea[data-name="text-shortcode"]',this.targetInsert=!1,this.singleInsert=!1,this.updateTimeout=!1,this.builderActivate()},a.AxisBuilder.prototype={builderActivate:function(){this.shortcodesToInterface(),this.builderBehaviour()},builderBehaviour:function(){var b=this;this.axisBuilderButton.click(function(){return b.switchEditors(),!1}),this.shortcodesWrap.on("click",".insert-shortcode",function(){var a=this.hash.replace("#",""),c="instant-insert";return b.shortcodes.fetchShortcodeEditorElement(a,c,b),!1}),this.axisBuilderCanvas.on("click","a.axisbuilder-clone",function(){return b.shortcodes.cloneElement(this,b),!1}).on("click","a.axisbuilder-trash",function(){return b.shortcodes.trashElement(this,b),!1}).on("click","a.axisbuilder-cell-add",function(){return b.shortcodes.addNewCell(this,b),!1}).on("change","select.axisbuilder-recalculate-shortcode",function(){var c=a(this).parents(".axisbuilder-sortable-element:eq(0)");return b.recalculateShortcode(c),!1}).on("axisbuilder-history-update",function(){b.activateDragging(this.axisBuilderParent,""),b.activateDropping(this.axisBuilderParent,"")})},switchEditors:function(){if(!this.axisBuilderButton.is(".disabled")){var a=this;return"active"!==this.axisBuilderStatus.val()?(this.wpDefaultEditorWrap.parent().addClass("axisbuilder-hidden-editor"),this.axisBuilderButton.removeClass("button-primary").addClass("button-secondary").text(this.axisBuilderButton.data("editor")),this.axisBuilderParent.removeClass("axisbuilder-hidden"),this.axisBuilderStatus.val("active"),"object"==typeof window.wp.editor.dfw&&window.wp.editor.dfw.off(),setTimeout(function(){a.shortcodesToInterface()},10)):(this.wpDefaultEditorWrap.parent().removeClass("axisbuilder-hidden-editor"),this.axisBuilderButton.addClass("button-primary").removeClass("button-secondary").text(this.axisBuilderButton.data("builder")),this.axisBuilderParent.addClass("axisbuilder-hidden"),this.axisBuilderStatus.val("inactive"),this.axisBuilderCanvas.addClass("loader").find(">*:not( .control-bar, .axisbuilder-insert-area )").remove(),"object"==typeof window.editorExpand&&(window.editorExpand.off(),window.editorExpand.on()),"yes"===this.axisBuilderDebug&&-1!==this.axisBuilderValues.val().indexOf("[")&&(new axisbuilder_log("Switching to Classic Editor. Page Builder is in Debug Mode and will empty the textarea so user can't edit shortcode directly","Editor"),this.tinyMceContent&&(this.tinyMceContent.setContent("",{format:"html"}),this.wpDefaultEditorArea.val("")))),!1}},shortcodesToInterface:function(b){if("active"!==this.axisBuilderStatus.val())return!0;"undefined"==typeof b&&(b=this.axisBuilderValues.val(),-1===b.indexOf("[")&&(b=this.wpDefaultEditorArea.val(),this.tinyMceDefined&&(b=window.switchEditors._wp_Nop(b)),this.axisBuilderValues.val(b)));var c=this,d={text:b,action:"axisbuilder_shortcodes_to_interface"};a.ajax({url:axisbuilder_admin_meta_boxes_builder.ajax_url,data:d,type:"POST",success:function(a){c.sendToBuilderCanvas(a),c.axisBuilderCanvas.removeClass("loader"),c.historySnapshot()}})},sendToBuilderCanvas:function(b){var c=a(b);this.axisBuilderCanvas.append(c),this.activateDragging(),this.activateDropping()},updateInnerTextarea:function(b,c){if("undefined"==typeof c&&(c=a(b).parents(".axisbuilder-layout-section:eq(0)")),c.length||(c=a(b).parents(".axisbuilder-layout-column:eq(0)")),!c.length)return!0;var d,e,f,g,h,i,j;if(c.is(".axisbuilder-layout-section")){var k=c.find(".axisbuilder-layout-column-no-cell");for(d=0;d<k.length;d++)this.updateInnerTextarea(!1,a(k[d]));for(k=c.find(".axisbuilder-layout-cell"),d=0;d<k.length;d++)this.updateInnerTextarea(!1,a(k[d]));for(e="",i=c.data("shortcode-handler"),f=c.find(">.axisbuilder-inner-shortcode >"+this.shortcodesData),g=c.find(">.axisbuilder-inner-shortcode > div "+this.shortcodesData+":not(.axisbuilder-layout-column .axisbuilder-sortable-element "+this.shortcodesData+", .axisbuilder-layout-cell .axisbuilder-layout-column "+this.shortcodesData+")"),h=f.val().match(new RegExp("\\["+i+".*?\\]")),d=0;d<g.length;d++)e+=a(g[d]).val();e=h[0]+"\n\n"+e+"[/"+i+"]",f.val(e)}if(c.is(".axisbuilder-layout-cell")){for(e="",j=c.data("width"),f=c.find(">.axisbuilder-inner-shortcode >"+this.shortcodesData),g=c.find(">.axisbuilder-inner-shortcode > div "+this.shortcodesData+":not(.axisbuilder-layout-column-no-cell .axisbuilder-sortable-element "+this.shortcodesData+")"),h=f.val().match(new RegExp("\\["+j+".*?\\]")),d=0;d<g.length;d++)e+=a(g[d]).val();e=h[0]+"\n\n"+e+"[/"+j+"]",f.val(e)}if(c.is(".axisbuilder-layout-column:not(.axisbuilder-layout-cell)")){var l=c.is(".axisbuilder-first-column")?" first":"";for(e="",j=c.data("width"),g=c.find(".axisbuilder-sortable-element "+this.shortcodesData),f=c.find(">.axisbuilder-inner-shortcode >"+this.shortcodesData),d=0;d<g.length;d++)e+=a(g[d]).val();e="["+j+l+"]\n\n"+e+"[/"+j+"]",f.val(e)}},updateTextarea:function(b){if("active"!==this.axisBuilderStatus.val())return!0;if(!b){var c=this;this.axisBuilderCanvas.find(".axisbuilder-layout-section").each(function(){var b=a(this).find(">.axisbuilder-inner-shortcode > div > .axisbuilder-inner-shortcode"),d=a(this).find(".axisbuilder-layout-cell .axisbuilder-layout-column-no-cell > .axisbuilder-inner-shortcode");b.length&&c.updateTextarea(b),d.length&&c.updateTextarea(d)}),b=a(".axisbuilder-data > div > .axisbuilder-inner-shortcode")}for(var d,e,f,g,h="",i=0,j=b.find(">"+this.shortcodesData),k={ab_one_full:1,ab_four_fifth:.8,ab_three_fourth:.75,ab_two_third:.66,ab_three_fifth:.6,ab_one_half:.5,ab_two_fifth:.4,ab_one_third:.33,ab_one_fourth:.25,ab_one_fifth:.2},l=0;l<j.length;l++)d=a(j[l]),e=d.val(),f=d.parents(".axisbuilder-layout-column-no-cell:eq(0)"),f.length?(g=f.data("width"),i+=k[g],i>1||0===l?(f.is(".axisbuilder-first-column")||(f.addClass("axisbuilder-first-column"),e=e.replace(new RegExp("^\\["+g),"["+g+" first"),d.val(e)),i=k[g]):f.is(".axisbuilder-first-column")&&(f.removeClass("axisbuilder-first-column"),e=e.replace(" first",""),d.val(e))):i=1,h+=e;var m=this.tinyMceDefined?window.tinyMCE.get("content"):void 0;"undefined"!==m&&(clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(function(){m.setContent(window.switchEditors.wpautop(h),{format:"html"})},500)),this.wpDefaultEditorArea.val(h),this.axisBuilderValues.val(h)},updateShortcode:function(a,b){var c=b.parents(".axisbuilder-layout-column:eq(0)"),d=b.parents(".axisbuilder-layout-section:eq(0)"),e=b.is(".axisbuilder-modal-group-element")?this.shortcodesData+":eq(0)":"> .axisbuilder-inner-shortcode >"+this.shortcodesData+":eq(0)",f=b.find(e),g=b.data("shortcode-handler"),h="",i={};if("yes"===this.axisBuilderDebug&&new axisbuilder_log(a,!1),"string"==typeof a)h=a;else{var j=this.updateHTML(b,a);h=j.output,i=j.tags}f.val(b.is(".axisbuilder-layout-section")||b.is(".axisbuilder-layout-cell")?f.val().replace(new RegExp("^\\["+g+".*?\\]"),i.open):h),d.length?this.updateInnerTextarea(!1,d):c.length&&this.updateInnerTextarea(!1,c),this.updateTextarea(),this.historySnapshot(),b.trigger("update")},updateHTML:function(b,c,d){var e,f,g,h;for(e in c)c.hasOwnProperty(e)&&(g=e.replace(/axisbuilderTB-/g,""),e!==g&&(h="undefined"!=typeof c[g]?c[g]+",":"",c[g]=h?h+c[e]:c[e],delete c[e]));for(e in c)if(c.hasOwnProperty(e)&&"content"!==e)if("string"==typeof c[e])c[e]=c[e].replace(/'(.+?)'/g,"‘$1’").replace(/'/g,"’");else if("object"==typeof c[e])for(f in c[e])c[e][f]=c[e][f].replace(/'(.+?)'/g,"‘$1’").replace(/'/g,"’");var i=b.data("shortcode-handler"),j=b.find("[data-update_with]"),k=b.find("[data-update_class_with]"),l="",m="",n="",o="",p="";b.is(".axisbuilder-no-visual-updates")||(k.attr("class",""),j.each(function(){l=a(this),m=l.data("update_with"),n=l.data("update_template")}),k.each(function(){o=a(this),p=o.data("update_class_with").split(",");for(var b=0;b<p.length;b++)"string"==typeof c[p[b]]&&(o.get(0).className+=" axisbuilder-"+p[b]+"-"+c[p[b]])}));var q={},r={};return r.tags=q,r.output=this.createShortcode(c,i,q,d),r},createShortcode:function(b,c,d,e){var f,g,h="",i="",j="",k=",",l="\n";if(d||(d={}),"undefined"!=typeof b.content){if("object"==typeof b.content){for(-1!==b.content[0].indexOf("[")&&(k=l),f=0;f<b.content.length;f++)b.content[f]=a.trim(b.content[f]);j=b.content.join(k)}else j=b.content;j=l+j+l,delete b.content}for(g in b)b.hasOwnProperty(g)&&(isNaN(g)?("object"==typeof b[g]&&(b[g]=b[g].join(",")),i+=g+"='"+b[g]+"' "):i+=b[g]+" ");return d.open="["+c+" "+a.trim(i)+"]",h=d.open,(j||"undefined"!=typeof e&&e===!0)&&(""===a.trim(j)&&(j=""),d.close="[/"+c+"]",h+=j+d.close),h+=l+l},recalculateShortcode:function(b){for(var c=[],d=!1,e=b.find("select.axisbuilder-recalculate-shortcode"),f=e.length-1;f>=0;f--)d=a(e[f]),c[d.data("attr")]=d.val();this.updateShortcode(c,b)},historySnapshot:function(a){var b=this;a||(a=150),setTimeout(function(){b.axisBuilderCanvas.trigger("axisbuilder-storage-update")},a)},compareVersion:function(a,b){var c,d,e,f=/(\.0)+[^\.]*$/;for(a=(a+"").replace(f,"").split("."),b=(b+"").replace(f,"").split("."),e=Math.min(a.length,b.length),c=0;e>c;c++)if(d=parseInt(a[c],10)-parseInt(b[c],10),0!==d)return d;return a.length-b.length},activateDragging:function(b,c){var d=a(window),e=this.compareVersion(a.ui.draggable.version,"1.10.9")<=0?!0:!1;(-1!==navigator.userAgent.indexOf("Safari")||-1!==navigator.userAgent.indexOf("Chrome"))&&(e=!1),e&&new axisbuilder_log("Drag and drop Positioning fix active");var f=this,g=b||this.axisBuilderParent,h={appendTo:"body",handle:">.menu-item-handle",helper:"clone",zIndex:2e4,scroll:!0,revert:!1,cursorAt:{left:20},start:function(b){var c=a(b.target);c.css({opacity:.4}),a(".axisbuilder-hover-active").removeClass("axisbuilder-hover-active"),f.axisBuilderCanvas.addClass("axisbuilder-select-target-"+c.data("dragdrop-level"))},drag:function(a,b){e&&(b.position.top-=parseInt(d.scrollTop(),10))},stop:function(b){a(b.target).css({opacity:1}),a(".axisbuilder-hover-active").removeClass("axisbuilder-hover-active"),f.axisBuilderCanvas.removeClass("axisbuilder-select-target-1 axisbuilder-select-target-2 axisbuilder-select-target-3 axisbuilder-select-target-4")}};"undefined"==typeof c&&(c=":not(.ui-draggable)"),g.find(".axisbuilder-drag"+c).draggable(h),h.cursorAt={left:33,top:33},h.handle=!1,g.find(".insert-shortcode").not(".ui-draggable").draggable(h)},activateDropping:function(b,c){var d=this,e=b||this.axisBuilderParent,f={greedy:!0,tolerance:"pointer",over:function(b,c){var e=a(this);d.isDropingAllowed(c.helper,e)&&e.addClass("axisbuilder-hover-active")},out:function(){a(this).removeClass("axisbuilder-hover-active")},drop:function(b,c){var e=a(this);if(!e.is(".axisbuilder-hover-active"))return!1;var f,g,h,i=e.find(">.axisbuilder-drag"),j={},k={},l="after",m=!1,n=[];for(h=0;h<i.length;h++){var o=i.eq(h);if(k=o.offset(),!(k.top<c.offset.top))break;m=o,f=k,n["top_"+k.top]||(g=0,n["top_"+k.top]=[]);var p=o.outerHeight()+k.top;g=g>p?g:p,n["top_"+k.top].push({index:h,top:k.top,left:k.left,height:o.outerHeight(),maxheight:o.outerHeight()+k.top})}if(f&&n["top_"+f.top].length>1&&g-40>c.offset.top){var q=!1;for(h=0;h<n["top_"+f.top].length&&n["top_"+f.top][h].left<c.offset.left;h++)q=n["top_"+f.top][h].index;q===!1&&(q=n["top_"+f.top][0].index,l="before"),m=i.eq(q)}if(m===!1&&(m=e,l="prepend"),m[0]===c.draggable[0])return!0;if(c.draggable[0].hash){var r=c.draggable.get(0).hash.replace("#","");j=a(a("#axisbuilder-tmpl-"+r).html()),c.draggable=j}var s=c.draggable.parents(".axisbuilder-drag:last");m[l](c.draggable),s.length&&d.updateInnerTextarea(!1,s);var t="after"===l?m.parents(".axisbuilder-drop"):m;0!==t.data("dragdrop-level")&&(d.updateTextarea(),d.updateInnerTextarea(c.draggable)),d.updateTextarea(),"undefined"!=typeof j&&(d.axisBuilderCanvas.removeClass("ui-droppable").droppable("destroy"),d.activateDragging(),d.activateDropping()),d.historySnapshot()}};"undefined"==typeof c&&(c=":not(.ui-droppable)"),"destroy"===c&&(e.find(".axisbuilder-drop").droppable("destroy"),c=""),e.find(".axisbuilder-drop"+c).droppable(f)},isDropingAllowed:function(a,b){return a.data("dragdrop-level")>b.data("dragdrop-level")?!0:!1}},a(document).ready(function(){a.AxisBuilderObj=new a.AxisBuilder,new a.AxisBuilderHistory({button:".history-action",canvas:".canvas-area",editor:".canvas-data"})})}(jQuery),function(a){"use strict";a.AxisBuilderShortcodes=a.AxisBuilderShortcodes||{},a.AxisBuilderShortcodes.fetchShortcodeEditorElement=function(b,c,d){var e=a("#axisbuilder-tmpl-"+b);return e.length?void("instant-insert"===c&&(d.sendToBuilderCanvas(e.html()),d.updateTextarea(),d.historySnapshot(0))):void 0},a.AxisBuilderShortcodes.cloneElement=function(b,c){var d=a(b),e=d.parents(".axisbuilder-sortable-element:eq(0)"),f=!1;if(e.length||(e=d.parents(".axisbuilder-layout-column:eq(0)"),e.length||(e=d.parents(".axisbuilder-layout-section:eq(0)"))),e.is(".axisbuilder-layout-cell")){var g=e.parents(".axisbuilder-layout-row:eq(0)").find(".axisbuilder-layout-cell").length;if("undefined"==typeof a.AxisBuilderLayoutRow.newCellOrder[g])return!1;f=!0}e.find("textarea").each(function(){this.innerHTML=this.value});var h=e.clone(),i=e.parents(".axisbuilder-layout-section, .axisbuilder-layout-column");h.removeClass("ui-draggable ui-droppable").find(".ui-draggable, .ui-droppable").removeClass("ui-draggable ui-droppable"),h.insertAfter(e),f&&a.AxisBuilderShortcodes.recalcCell(b,c),(e.is(".axisbuilder-layout-section")||e.is(".axisbuilder-layout-column")||i.length)&&i.length&&(c.updateTextarea(),c.updateInnerTextarea(e)),c.activateDragging(),c.activateDropping(),c.updateTextarea(),c.historySnapshot()},a.AxisBuilderShortcodes.trashElement=function(b,c){var d=a(b),e=d.parents(".axisbuilder-sortable-element:eq(0)"),f=!1,g=!1,h=200;if(e.length?f=d.parents(".axisbuilder-inner-shortcode:eq(0)"):(e=d.parents(".axisbuilder-layout-column:eq(0)"),f=d.parents(".axisbuilder-layout-section:eq(0)>.axisbuilder-inner-shortcode"),e.length||(e=d.parents(".axisbuilder-layout-section:eq(0)"),f=!1)),e.length&&e.is(".axisbuilder-layout-cell")){if(!(f.find(".axisbuilder-layout-cell").length>1))return!1;g=!0,h=0}e.hide(h,function(){g&&a.AxisBuilderShortcodes.removeCell(b,c),e.remove(),f&&f.length&&c.updateInnerTextarea(f),c.updateTextarea(),""===c.axisBuilderValues.val()&&c.activateDropping(c.axisBuilderParent,"destroy"),c.historySnapshot()})},a.AxisBuilderShortcodes.addNewCell=function(b,c){a.AxisBuilderLayoutRow.modifyCellCount(b,c,0)},a.AxisBuilderShortcodes.recalcCell=function(b,c){a.AxisBuilderLayoutRow.modifyCellCount(b,c,-1)},a.AxisBuilderShortcodes.removeCell=function(b,c){a.AxisBuilderLayoutRow.modifyCellCount(b,c,-2)},a.AxisBuilderLayoutRow={cellSize:[["ab_cell_one_full","1/1",1],["ab_cell_four_fifth","4/5",.8],["ab_cell_three_fourth","3/4",.75],["ab_cell_two_third","2/3",.66],["ab_cell_three_fifth","3/5",.6],["ab_cell_one_half","1/2",.5],["ab_cell_two_fifth","2/5",.4],["ab_cell_one_third","1/3",.33],["ab_cell_one_fourth","1/4",.25],["ab_cell_one_fifth","1/5",.2]],newCellOrder:[["ab_cell_one_full","1/1"],["ab_cell_one_half","1/2"],["ab_cell_one_third","1/3"],["ab_cell_one_fourth","1/4"],["ab_cell_one_fifth","1/5"]],cellSizeVariations:{4:{1:["ab_cell_one_fourth","ab_cell_one_fourth","ab_cell_one_fourth","ab_cell_one_fourth"],2:["ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_two_fifth"],3:["ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_two_fifth","ab_cell_one_fifth"],4:["ab_cell_one_fifth","ab_cell_two_fifth","ab_cell_one_fifth","ab_cell_one_fifth"],5:["ab_cell_two_fifth","ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_one_fifth"]},3:{1:["ab_cell_one_third","ab_cell_one_third","ab_cell_one_third"],2:["ab_cell_one_fourth","ab_cell_one_fourth","ab_cell_one_half"],3:["ab_cell_one_fourth","ab_cell_one_half","ab_cell_one_fourth"],4:["ab_cell_one_half","ab_cell_one_fourth","ab_cell_one_fourth"],5:["ab_cell_one_fifth","ab_cell_one_fifth","ab_cell_three_fifth"],6:["ab_cell_one_fifth","ab_cell_three_fifth","ab_cell_one_fifth"],7:["ab_cell_three_fifth","ab_cell_one_fifth","ab_cell_one_fifth"],8:["ab_cell_one_fifth","ab_cell_two_fifth","ab_cell_two_fifth"],9:["ab_cell_two_fifth","ab_cell_one_fifth","ab_cell_two_fifth"],10:["ab_cell_two_fifth","ab_cell_two_fifth","ab_cell_one_fifth"]},2:{1:["ab_cell_one_half","ab_cell_one_half"],2:["ab_cell_two_third","ab_cell_one_third"],3:["ab_cell_one_third","ab_cell_two_third"],4:["ab_cell_one_fourth","ab_cell_three_fourth"],5:["ab_cell_three_fourth","ab_cell_one_fourth"],6:["ab_cell_one_fifth","ab_cell_four_fifth"],7:["ab_cell_four_fifth","ab_cell_one_fifth"],8:["ab_cell_two_fifth","ab_cell_three_fifth"],9:["ab_cell_three_fifth","ab_cell_two_fifth"]}},modifyCellCount:function(b,c,d){var e=a(b),f=e.parents(".axisbuilder-layout-row:eq(0)"),g=f.find(".axisbuilder-layout-cell"),h=g.length+d,i=a.AxisBuilderLayoutRow.newCellOrder[h];"undefined"!=typeof i&&(h!==g.length?a.AxisBuilderLayoutRow.changeMultipleCellSize(g,i,c):(a.AxisBuilderLayoutRow.changeMultipleCellSize(g,i,c),a.AxisBuilderLayoutRow.appendCell(f,i),c.activateDropping()),c.updateInnerTextarea(!1,f),c.updateTextarea(),c.historySnapshot(0))},appendCell:function(b,c){var d=b.find("> .axisbuilder-inner-shortcode"),e=c[0].replace("ab_cell_","ab_shortcode_cells_").replace("_one_full",""),f=a(a("#axisbuilder-tmpl-"+e).html());d.append(f)},changeMultipleCellSize:function(b,c,d,e){var f="",g=c;b.each(function(b){if(e){f=c[b];for(var h in a.AxisBuilderLayoutRow.cellSize)f===a.AxisBuilderLayoutRow.cellSize[h][0]&&(g=a.AxisBuilderLayoutRow.cellSize[h])}a.AxisBuilderLayoutRow.changeSingleCellSize(a(this),g,d)})},changeSingleCellSize:function(a,b,c){var d=a.data("width"),e=a.find("> .axisbuilder-sorthandle > .axisbuilder-column-size"),f=a.find("> .axisbuilder-inner-shortcode > "+c.shortcodesData),g=f.val();g=g.replace(new RegExp("^\\["+d,"g"),"["+b[0]),g=g.replace(new RegExp(d+"\\]","g"),b[0]+"]"),f.val(g),a.removeClass(d).addClass(b[0]),a.attr("data-width",b[0]).data("width",b[0]),a.attr("data-shortcode-handler",b[0]).data("shortcode-handler",b[0]),a.attr("data-shortcode-allowed",b[0]).data("shortcode-allowed",b[0]),e.text(b[1])}}}(jQuery),function(a){"use strict";a.AxisBuilderHistory=a.AxisBuilderHistory||{},a.AxisBuilderHistory=function(b){var c={steps:40,button:"",canvas:"",editor:"",event:"axisbuilder-storage-update"};return"undefined"==typeof Storage?!1:(this.doc=a(document),this.options=a.extend({},c,b),void this.setups())},a.AxisBuilderHistory.prototype={setups:function(){this.button=a(this.options.button),this.canvas=a(this.options.canvas),this.editor=a(this.options.editor),this.key=this.create_array_key(),this.storage=this.get()||[],this.maximum=this.storage.length-1,this.index=this.get(this.key+"index"),("undefined"==typeof this.index||null===this.index)&&(this.index=this.maximum),this.undoButton=this.button.find(".undo-data"),this.redoButton=this.button.find(".redo-data"),this.clear(),this.bindEvents()},create_array_key:function(){var a="axisbuilder"+axisbuilder_admin_meta_boxes_builder.theme_name+axisbuilder_admin_meta_boxes_builder.theme_version+axisbuilder_admin_meta_boxes_builder.post_id+axisbuilder_admin_meta_boxes_builder.plugin_version;return a.replace(/[^a-zA-Z0-9]/g,"").toLowerCase()},bindEvents:function(){var a=this;this.canvas.on("axisbuilder-storage-update",function(){a.snapshot()}),this.button.on("click","a.undo-data",function(){return a.undo(),!1}),this.button.on("click","a.redo-data",function(){return a.redo(),!1}),this.doc.bind("keydown.AxisBuilderHistory",function(b){b=b||window.event,90===b.which&&(b.ctrlKey||b.ctrlKey&&b.shiftKey)&&(setTimeout(function(){a.undo()},100),b.stopImmediatePropagation()),89===b.which&&(b.ctrlKey||b.ctrlKey&&b.shiftKey)&&(setTimeout(function(){a.redo()},100),b.stopImmediatePropagation())})},get:function(a){var b=a||this.key;return JSON.parse(sessionStorage.getItem(b))},set:function(a,b){var c=a||this.key,d=b||JSON.stringify(this.storage);try{sessionStorage.setItem(c,d)}catch(e){new axisbuilder_log("Storage Limit reached. Your Browser does not offer enough session storage to save more steps for the undo/redo history.","Storage"),new axisbuilder_log(e,"Storage"),this.clear(),this.redoButton.addClass("inactive-history"),this.undoButton.addClass("inactive-history")}},clear:function(){sessionStorage.removeItem(this.key),sessionStorage.removeItem(this.key+"index"),this.storage=[],this.index=null},undo:function(){return this.index-1>=0&&(this.index--,this.canvasUpdate(this.storage[this.index])),!1},redo:function(){return this.index+1<=this.maximum&&(this.index++,this.canvasUpdate(this.storage[this.index])),!1},canvasUpdate:function(a){"undefined"==typeof this.tinyMCE&&(this.tinyMCE="undefined"==typeof window.tinyMCE?!1:window.tinyMCE.get(this.options.editor.replace("#",""))),this.tinyMCE&&this.tinyMCE.setContent(window.switchEditors.wpautop(a[0]),{format:"html"}),this.editor.val(a[0]),this.canvas.html(a[1]),sessionStorage.setItem(this.key+"index",this.index),this.index<=0?this.undoButton.addClass("inactive-history"):this.undoButton.removeClass("inactive-history"),this.index+1>this.maximum?this.redoButton.addClass("inactive-history"):this.redoButton.removeClass("inactive-history"),this.canvas.trigger("axisbuilder-history-update")},snapshot:function(){this.canvas.find("textarea").each(function(){this.innerHTML=this.value}),this.storage=this.storage||this.get()||[],this.index=this.index||this.get(this.key+"index"),("undefined"==typeof this.index||null===this.index)&&(this.index=this.storage.length-1);var a=[this.editor.val(),this.canvas.html().replace(/modal-animation/g,"")],b=this.storage[this.index];("undefined"==typeof b||b[0]!==a[0])&&(this.index++,this.storage=this.storage.slice(0,this.index),this.storage.push(a),this.options.steps<this.storage.length&&this.storage.shift(),this.set()),this.maximum=this.storage.length-1,1===this.storage.length||0===this.index?this.undoButton.addClass("inactive-history"):this.undoButton.removeClass("inactive-history"),this.storage.length-1===this.index?this.redoButton.addClass("inactive-history"):this.redoButton.removeClass("inactive-history")}}}(jQuery),function(a){"use strict";a.AxisBuilderHelper=a.AxisBuilderHelper||{},a.AxisBuilderHelper.wp_media=a.AxisBuilderHelper.wp_media||[],a(document).ready(function(){a.AxisBuilderHelper.check_depedencies(),a.AxisBuilderHelper.wp_media_advanced()}),a.AxisBuilderHelper.check_depedencies=function(){var b=a("body");b.on("change",".axisbuilder-style input[type=hidden], .axisbuilder-style input[type=text], .axisbuilder-style input[type=checkbox], .axisbuilder-style textarea, .axisbuilder-style select, .axisbuilder-style radio",function(){var c=a(this),d=c.parents(".axisbuilder-modal:eq(0)");d.length||(d=b);var e=this.id.replace(/axisbuilderTB-/,""),f=d.find('.axisbuilder-form-element-container[data-check-element="'+e+'"]'),g=c.parents(".axisbuilder-form-element-container:eq(0)").is(".axisbuilder-hidden"),h=this.value;return c.is("input[type=checkbox]")&&!c.prop("checked")&&(h=""),f.length?void f.each(function(){var b=!1,c=a(this),d=c.data("check-operator"),e=c.data("check-value").toString();if(!g)switch(d){case"equals":b=h===e?!0:!1;break;case"not":b=h!==e?!0:!1;break;case"is_larger":b=h>e?!0:!1;break;case"is_smaller":b=e>h?!0:!1;break;case"contains":b=-1!==h.indexOf(e)?!0:!1;break;case"doesnot_contain":b=-1===h.indexOf(e)?!0:!1;break;case"is_empty_or":b=""===h||h===e?!0:!1;break;case"not_empty_and":b=""!==h||h!==e?!0:!1}b===!0&&c.is(".axisbuilder-hidden")?(c.css({display:"none"}).removeClass("axisbuilder-hidden").find("select, radio, input[type=checkbox]").trigger("change"),c.slideDown()):b!==!1||c.is(".axisbuilder-hidden")||(c.css({display:"block"}).addClass("axisbuilder-hidden").find("select, radio, input[type=checkbox]").trigger("change"),c.slideUp())}):!0})},a.AxisBuilderHelper.wp_media_advanced=function(){var b=[],c=wp.media;a("body").on("click",".axisbuilder-image-upload",function(d){d.preventDefault();var e=a(this),f=e.data(),g=_.random(0,1e18);return a.AxisBuilderHelper.wp_media.unshift(this),b[g]?void b[g].open():(b[g]=wp.media({frame:f.frame,state:f.state,className:f["class"],button:{text:f.button},library:{type:"image"}}),b[g].states.add([new wp.media.controller.Library({id:"axisbuilder_insert_single",title:e.data("title"),priority:20,editable:!0,multiple:!1,toolbar:"select",filterable:"uploaded",allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!1,library:c.query(b[g].options.library)})]),b[g].on("close",function(){_.defer(function(){a.AxisBuilderHelper.wp_media.shift()})}),void b[g].open())})}}(jQuery);